{% extends '/Layouts/navbar.html' %}
{% block title %}Reservaciones Aceptadas{% endblock %}

{% block content %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/dashpre.css') }}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<div class="content">
    <div class="agenda">
        <h2>Reservaciones Aceptadas</h2>
        {% if reservaciones %}
            <ul class="reservations-list">
                {% for reservacion in reservaciones %}
                    <li class="reservation-item" data-reservation-id="{{ reservacion.id }}">
                        <div>
                            <h5 class="mb-1 arial-font">Tipo de Servicio: {{ reservacion.tipo_de_servicio }}</h5>
                            <p class="mb-1 arial-font">Fecha: {{ reservacion.fecha }} - Hora: {{ reservacion.hora_seleccionada }}</p>
                        </div>
                        <div class="reservation-actions">
                            <button onclick="showDetails('{{ reservacion.id }}')" class="btn btn-info">Ver Detalles</button>
                            <button onclick="showCancelModal('{{ reservacion.id }}', '{{ reservacion.fecha }}', '{{ reservacion.hora_seleccionada }}')" class="btn btn-danger">Cancelar</button>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="no-reservations">No hay reservaciones aceptadas.</p>
        {% endif %}
    </div>
</div>

<div id="detailsModal" class="modal" tabindex="-1">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="reservationDetails"></div>
    </div>
</div>

<div id="cancelModal" class="modal" tabindex="-1">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Confirmar Cancelación</h2>
        <p id="cancelWarning" class="text-danger"></p>
        <p>¿Está seguro que desea cancelar esta reservación?</p>
        <textarea id="cancelReason" rows="3" class="form-control" placeholder="Razón de la cancelación"></textarea>
        <br>
        <button onclick="cancelReservation()" class="btn btn-danger" id="confirmCancelButton">Confirmar Cancelación</button>
        <button onclick="closeModal('cancelModal')" class="btn btn-secondary">Cerrar</button>
    </div>
</div>

<script>
    var reservacionesData = '{{ reservaciones | tojson | safe }}';
</script>
<script src="{{ url_for('static', filename='js/Creser.js') }}"></script>
{% endblock %}